{% from "partial/icon.html" import icon %}
<!DOCTYPE html>
<html lang="en">
  <head>
    {% include "partial/meta.html" %}
    <link rel="stylesheet" href="{{ url_for('static', path='css/series_navigation.css') }}">
  </head>
  <body>
    <main class="main-wrapper">
      <a href="/blog" class="back-link">
        {{ icon("arrow_back", size="16") }}Back to Blog
      </a>
      
      <!-- Series Navigation Top -->
      {% if current_series and navigation %}
        {% include "partial/series_navigation.html" %}
      {% endif %}
      
      <article class="post-article{% if post.featured %} featured{% endif %}">
        {% if post.cover_image %}
          <div class="post-image">
            <img src="{{ url_for('static', path='images/posts/' + post.cover_image) }}" 
                 alt="{{ post.title }}" loading="lazy">
            {% if post.featured %}
              <span class="featured-badge">Featured</span>
            {% endif %}
          </div>
        {% endif %}
        <div class="post-content">
          <div class="post-meta">
            <time datetime="{{ post.created.isoformat() }}">
              {{ post.created.strftime('%B %d, %Y') }}
            </time>
            {% if post.authors %}
              <span class="authors">
                by 
                {% for author in post.authors %}
                  <span class="author">{{ author.name }}</span>{% if not loop.last %}, {% endif %}
                {% endfor %}
              </span>
            {% endif %}
          </div>
          
          <!-- Series Context Info -->
          {% if current_series %}
            <div class="series-context">
              <strong>Part {{ navigation.current_index }} of {{ navigation.total }}</strong> in 
              <a href="/blog/s/{{ current_series.slug }}">{{ current_series.title }}</a>
            </div>
          {% endif %}
          
          <h1 class="post-title">{{ post.title }}</h1>
          <p class="post-description">{{ post.description }}</p>
          {% if post.tags %}
            <div class="post-tags">
              {% for tag in post.tags %}
                <span class="tag">{{ tag }}</span>
              {% endfor %}
            </div>
          {% endif %}
          <div class="post-actions">
            {% if not post.draft %}
              <!--
              <span class="status published">Published</span>
              -->
            {% else %}
              <span class="status draft">Draft</span>
            {% endif %}
          </div>
          
          <!-- Series Selection -->
          {% if not current_series and series_list %}
            <div class="series-selection">
              <strong>Read as part of:</strong>
              {% for series in series_list %}
                <a href="/blog/s/{{ series.slug }}/p/{{ post.slug }}" class="series-link">{{ series.title }}</a>{% if not loop.last %}, {% endif %}
              {% endfor %}
              <span class="or-standalone">or <a href="/blog/p/{{ post.slug }}">standalone</a></span>
            </div>
          {% endif %}
          
          <hr>
          <div class="post-body">
            {{ body | safe }}
          </div>
        </div>
      </article>
      
      <!-- Series Navigation Bottom -->
      {% if current_series and navigation %}
        {% include "partial/series_navigation.html" %}
      {% endif %}
      
      {% include "partial/theme_switch.html" %}
    </main>
  </body>
</html>